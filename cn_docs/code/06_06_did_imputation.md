---
layout: default
title: did_imputation
parent: Stata代码
nav_order: 6
mathjax: true
image: "../../../assets/images/DiD.png"
---

# did_imputation 
{: .no_toc }

## 目录
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## 说明

- 基于：Borusyak, Jaravel, Spiess 2021。[重新审视事件研究设计：稳健且有效的估计](https://arxiv.org/abs/2108.12419)，最后修订于2024年1月16日（第5版）。
- 程序版本（如有）：2023年11月22日
- 最后检查：2024年11月


## 安装

```stata
ssc install did_imputation, replace
```

查看帮助文件：

```stata
help did_imputation
```

## 测试命令

请确保使用[这里](https://asjadnaqvi.github.io/DiD/docs/code/06_03_data/)给出的脚本生成数据

让我们尝试使用10个前置期和滞后期的基本`did_imputation`命令：


```stata
did_imputation Y i t first_treat, horizons(0/10) pretrend(10) minn(0)
```

这给了我们：

```stata
                                                         Number of obs = 1,438
------------------------------------------------------------------------------
           Y | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
        tau0 |   .0787163   .2677837     0.29   0.769      -.44613    .6035626
        tau1 |   8.637227   .2815466    30.68   0.000     8.085406    9.189048
        tau2 |   17.78728   .2329168    76.37   0.000     17.33078    18.24379
        tau3 |   26.07725   .2293303   113.71   0.000     25.62777    26.52673
        tau4 |   34.76562   .2815757   123.47   0.000     34.21374     35.3175
        tau5 |   42.93274   .2848896   150.70   0.000     42.37437    43.49111
        tau6 |   52.00695   .2787334   186.58   0.000     51.46064    52.55326
        tau7 |   60.20919   .2526519   238.31   0.000       59.714    60.70438
        tau8 |   68.90038   .2317813   297.26   0.000      68.4461    69.35466
        tau9 |   77.38383   .2652313   291.76   0.000     76.86399    77.90368
       tau10 |   85.83142    .309541   277.29   0.000     85.22473    86.43811
        pre1 |   .1206052   .2866341     0.42   0.674    -.4411872    .6823977
        pre2 |   .2116369   .3320804     0.64   0.524    -.4392287    .8625025
        pre3 |   .0601094   .2808867     0.21   0.831    -.4904184    .6106372
        pre4 |   .0568874   .2809316     0.20   0.840    -.4937285    .6075032
        pre5 |  -.2050823   .2642319    -0.78   0.438    -.7229672    .3128027
        pre6 |  -.3225205   .2343503    -1.38   0.169    -.7818387    .1367977
        pre7 |  -.2239894   .2511694    -0.89   0.373    -.7162724    .2682936
        pre8 |    .052194   .2243524     0.23   0.816    -.3875287    .4919166
        pre9 |   .0285485   .2358903     0.12   0.904    -.4337881     .490885
       pre10 |   .0962904   .2314293     0.42   0.677    -.3573028    .5498836
------------------------------------------------------------------------------
```



为了绘制估计结果，我们可以使用`event_plot`命令（`ssc install event_plot, replace`），如下所示：


```stata
event_plot, default_look graph_opt(xtitle("事件发生后时期") ytitle("平均效应") ///
	标题("did_imputation") xlabel(-10(1)10)) stub_lag(tau#) stub_lead(pre#) together	 
```

我们得到：

<img src="../../../assets/images/did_imputation_1.png" width="100%">